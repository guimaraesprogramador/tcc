--inseir a tabela das microrregiao de gv
insert into cidades(nomes,geom)
select a.nm_municip,a.geom
from public."Bacia_MG" as a 
where a.nm_municip ='COROACI'
--criar tabela
create table nascentes_mata_completa(
id_muncipio varchar(254),
limite_forestacao double precision,
id_app int,
florestacao varchar(254),
AreaM2 double precision,
geom geometry
)
--
create table cidades(
nomes varchar(60),
geom geometry
);

--
insert into public."nascentes_mata_completa"(id_muncipio,
limite_forestacao,id_app,florestacao,AreaM2,geom)
select a.nomes,a.NUM_AREA,
a.IDF,a.NOM_TEMA,ST_Area(ST_Intersection(shp.geom,a.st_intersection)),ST_Intersection(shp.geom,a.st_intersection)
from public."gv_nascentes" as a,
PUBLIC."Quadrante_1_vetor" as shp
where ST_Intersects(shp.geom,a.st_intersection) = true;

--validar da dados geometria

update public."nascentes da microrregaio de gv"
set geom = ST_MakeValid(geom);

--selecionar a quantidade de cada cidade do SICAR
SELECT COUNT(id_app) as soma
	FROM public.nascentes_mata_completa
	where  id_muncipi = 'COROACI'

--codigo do numero de nascente por micrroregioa de Gv no SICAR
SELECT  count(idf) as soma
	FROM public.gv_nascentes
	where  nomes = 'CAMPANÁRIO'
--codigo de interseção entre quadrante 1 e 2
select ST_Area(ST_Intersection(recorde.geom,quadrante.geom)) as tamanho_area, ST_Intersection(recorde.geom,quadrante.geom)as geom
into recorde_1_02
from public."Quadrante_1_mata" as recorde,
public."Quadrante_02_mata" as quadrante
where ST_Intersects(recorde.geom,quadrante.geom) = true;
